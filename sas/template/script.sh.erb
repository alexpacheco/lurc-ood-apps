#!/usr/bin/env bash

# Set working directory to home directory
cd "${HOME}"

# Reset module environment (may require login shell for some HPC clusters)
#module purge && module restore
module load sas/<%= context.version %>

# Create GaussView Launcher
echo "[Desktop Entry]" > Desktop/SAS.desktop
echo "Version=1.0" >> Desktop/SAS.desktop
echo "Type=Application" >> Desktop/SAS.desktop
echo "Name=SAS" >> Desktop/SAS.desktop
echo "Comment=SAS" >> Desktop/SAS.desktop
echo "Exec=/share/Apps/sas/9.4/SASFoundation/9.4/sas" >> Desktop/SAS.desktop
echo "Icon=" >> Desktop/SAS.desktop
echo "Path=$HOME" >> Desktop/SAS.desktop
echo "Terminal=false" >> Desktop/SAS.desktop
echo "StartupNotify=false" >> Desktop/SAS.desktop

chmod +x Desktop/SAS.desktop

# Define Container Image


# Start up desktop
source "<%= session.staged_root.join("desktops", "#{context.desktop}.sh") %>"

# Delete GaussView launcher
rm -rf Desktop/SAS.desktop

